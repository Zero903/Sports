<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta http-equiv="Access-Control-Allow-Origin" content="https://script.google.com">
    <title>é‹å‹•å»ºè­°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .table-container {
          overflow-y: auto;
          background-color: #f8f9fa;
          padding: 15px; 
          border-radius: 10px;
          margin-bottom: 30px;
      }
      tr:hover {
        background-color: #e9ecef;
      }
      a, .btn-link {
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
        <header class="mb-4">
            <h1 class="text-center">é‹å‹•å»ºè­°</h1>
        </header>
        <section class="mb-4">
            <div class="row g-3">
                <div class="col-md-4">
                    <label for="goal" class="form-label">å¥åº·ç›®æ¨™ï¼š</label>
                    <select id="goal" class="form-select">
                        <!-- é¸é …æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="intensity" class="form-label">é‹å‹•å¼·åº¦ï¼š</label>
                    <select id="intensity" class="form-select">
                        <!-- é¸é …æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="bodyPart" class="form-label">é›éŠéƒ¨ä½ï¼š</label>
                    <select id="bodyPart" class="form-select">
                        <!-- é¸é …æœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </select>
                </div>
            </div>
        </section>
        <section id="suggestions" class="mt-4 table-container">
            <!-- é‹å‹•å»ºè­°å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
        </section>
        <footer class="text-center mt-5 fixed-bottom" style="background-color: white; padding-top: 20px;">
            <p>Copyright Â© 2024 Zero. All Right ğŸ‘Œ.</p>
        </footer>
    </div>
  </body>
  <script>
        let exerciseData = [];
        window.onload = function() {
            fetchExerciseData();
        };

        async function fetchExerciseData() {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbwN5IBoZpqZ7741TqbZOIUzCkOaX2sOzzykCw0bDk9YH95iTHH-gvQy26QojO38dxxO6w/exec');
                const data = await response.text();
                processData(data);
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        function processData(data) {
            exerciseData = JSON.parse(data);
            populateFilters();
            displayExerciseData(exerciseData); // åˆå§‹é¡¯ç¤ºæ‰€æœ‰è³‡æ–™

            // ç›£è½ä¸‹æ‹‰é¸å–®è®Šå‹•äº‹ä»¶
            document.getElementById('goal').addEventListener('change', filterExerciseData);
            document.getElementById('intensity').addEventListener('change', filterExerciseData);
            document.getElementById('bodyPart').addEventListener('change', filterExerciseData);
        }

        function populateFilters() {
            const goals = [...new Set(exerciseData.map(ex => ex.goal))];
            const intensities = [...new Set(exerciseData.map(ex => ex.intensity))];
            const bodyParts = [...new Set(exerciseData.map(ex => ex.bodyPart))];
            populateSelect('goal', goals);
            populateSelect('intensity', intensities);
            populateSelect('bodyPart', bodyParts);
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'è«‹é¸æ“‡';
            select.appendChild(defaultOption);

            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                select.appendChild(opt);
            });
        }

        let currentSortColumn = '';
        let currentSortOrder = 'asc';
        
        function sortTable(column) {
            if (currentSortColumn === column) {
                currentSortOrder = currentSortOrder === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = column;
                currentSortOrder = 'asc';
            }
            const sortedData = [...exerciseData].sort((a, b) => {
                if (a[column] < b[column]) return currentSortOrder === 'asc' ? -1 : 1;
                if (a[column] > b[column]) return currentSortOrder === 'asc' ? 1 : -1;
                return 0;
            });
            displayExerciseData(sortedData);
        }
    
        function filterExerciseData() {
            const goal = document.getElementById('goal').value;
            const intensity = document.getElementById('intensity').value;
            const bodyPart = document.getElementById('bodyPart').value;

            const filteredData = exerciseData.filter(exercise =>
                (goal === '' || exercise.goal === goal) &&
                (intensity === '' || exercise.intensity === intensity) &&
                (bodyPart === '' || exercise.bodyPart === bodyPart)
            );

            displayExerciseData(filteredData);
        }

        function displayExerciseData(data) {
            let tableContent = `
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('name')">é‹å‹•åç¨±</button></th>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('goal')">å¥åº·ç›®æ¨™</button></th>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('frequency')">é »ç‡(æ¬¡/é€±)</button></th>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('duration')">æ™‚é•·(åˆ†é˜/æ¬¡)</button></th>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('intensity')">é‹å‹•å¼·åº¦</button></th>
                            <th class="text-start fw-bold"><button class="btn btn-link" onclick="sortTable('bodyPart')">é›éŠéƒ¨ä½</button></th>
                        </tr>
                    </thead>
                    <tbody id="exerciseTableBody">
            `;
            if (data.length > 0) {
                data.forEach(exercise => {
                    tableContent += `
                        <tr onclick="window.open('https://www.google.com/search?q=${exercise.name}', '_blank')">
                            <td>${exercise.name}</td>
                            <td>${exercise.goal}</td>
                            <td>${exercise.frequency}</td>
                            <td>${exercise.duration}</td>
                            <td>${exercise.intensity}</td>
                            <td>${exercise.bodyPart}</td>
                        </tr>
                    `;
                });
            } else {
                tableContent += `
                    <tr>
                        <td colspan="6" class="text-center">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„é‹å‹•å»ºè­°ã€‚</td>
                    </tr>
                `;
            }
            tableContent += `
                    </tbody>
                </table>
            `;
            document.getElementById('suggestions').innerHTML = tableContent;
        }
    </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</html>
